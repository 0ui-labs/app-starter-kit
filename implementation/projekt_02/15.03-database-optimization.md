# Arbeitspaket 15.03: Database Query Optimization

## Ziel
Optimierung der Datenbank-Performance durch Indexes, Query Optimization und Batch Loading.

## Kontext
- **Database**: PostgreSQL mit Neon
- **ORM**: Prisma
- **Patterns**: Indexes, DataLoader, Cursor Pagination, Bulk Operations

## Implementierungsschritte

1. **Index Optimization**
   - Composite Indexes für häufige WHERE/ORDER BY Kombinationen
   - Full-text Search Indexes
   - Partial Indexes für filtered Queries
   - Analyze Query Plans mit EXPLAIN

2. **DataLoader Implementation**
   - N+1 Query Prevention
   - Batch Loading von Relations
   - Request-scoped Caching
   - Automatic Batching

3. **Pagination Utilities**
   - Cursor-based Pagination Helper
   - Offset Pagination Alternative
   - Count Query Optimization
   - Estimated Count für große Tabellen

4. **Query Optimization Utilities**
   - `packages/db/src/optimizations.ts`
   - Automatic Include Resolution
   - Bulk Create/Update Operations
   - Soft Delete mit Cascade

5. **Prisma Schema Updates**
   - Index Definitionen hinzufügen
   - Composite Unique Constraints
   - Migration generieren und ausführen

## Erfolgskriterien
- [ ] Indexes definiert und migriert
- [ ] DataLoader implementiert
- [ ] Pagination Utilities erstellt
- [ ] Query Performance verbessert (< 100ms)
- [ ] EXPLAIN ANALYZE zeigt Index Usage

## Zeitschätzung
20 Minuten