# Sub-Task 06.02: User Schemas erstellen

## Ziel
Implementierung User-spezifischer Validation Schemas mit Zod.

## Package
`@starter-kit/api`

## Datei
`packages/api/src/schemas/user.ts`

## Implementation

```typescript
import { z } from 'zod';
import { emailSchema, idSchema } from './base';

// User entity
export const userSchema = z.object({
  id: idSchema,
  email: emailSchema,
  name: z.string().min(1).max(100),
  role: z.enum(['user', 'admin']).default('user'),
  createdAt: z.date(),
  updatedAt: z.date(),
});

// Create user input
export const createUserSchema = z.object({
  email: emailSchema,
  name: z.string().min(1).max(100),
  password: z.string().min(8).max(100)
    .regex(/[A-Z]/, 'Must contain uppercase')
    .regex(/[a-z]/, 'Must contain lowercase')
    .regex(/[0-9]/, 'Must contain number'),
});

// Update user input
export const updateUserSchema = z.object({
  name: z.string().min(1).max(100).optional(),
  email: emailSchema.optional(),
});

// User filters
export const userFiltersSchema = z.object({
  email: emailSchema.optional(),
  role: z.enum(['user', 'admin']).optional(),
  search: z.string().optional(),
});
```

## Komponenten

### 1. User Entity Schema
- Vollständige User-Datenstruktur
- ID als UUID
- Email mit Validation
- Name: 1-100 Zeichen
- Role: Enum (user/admin)
- Timestamps

### 2. Create User Schema
- Input Validation für neue User
- **Email**: Reused von base.ts
- **Name**: 1-100 Zeichen
- **Password Requirements**:
  - Minimum 8 Zeichen
  - Maximum 100 Zeichen
  - Mindestens 1 Großbuchstabe
  - Mindestens 1 Kleinbuchstabe
  - Mindestens 1 Zahl

### 3. Update User Schema
- Partial Update Support
- Alle Felder optional
- Name und Email updatebar
- Password Update separater Endpoint

### 4. User Filters Schema
- Für List/Search Operations
- Email Filter (exact match)
- Role Filter
- Search Term (für Name/Email)

## Password Security Notes

```typescript
// Erweiterte Password Validation (optional)
export const strongPasswordSchema = z.string()
  .min(12)
  .max(128)
  .regex(/[A-Z]/, 'Must contain uppercase')
  .regex(/[a-z]/, 'Must contain lowercase')
  .regex(/[0-9]/, 'Must contain number')
  .regex(/[!@#$%^&*]/, 'Must contain special character')
  .refine((password) => {
    // Check for common passwords
    const commonPasswords = ['password', '12345678', 'qwerty'];
    return !commonPasswords.some(common => 
      password.toLowerCase().includes(common)
    );
  }, 'Password too common');
```

## Type Exports

```typescript
// Type inference helpers
export type User = z.infer<typeof userSchema>;
export type CreateUserInput = z.infer<typeof createUserSchema>;
export type UpdateUserInput = z.infer<typeof updateUserSchema>;
export type UserFilters = z.infer<typeof userFiltersSchema>;
```

## Prisma Schema Alignment

Stelle sicher dass Zod Schemas mit Prisma Schema übereinstimmen:

```prisma
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String
  role      Role     @default(USER)
  password  String   // Hashed
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  USER
  ADMIN
}
```

## Erfolgskriterien
- [ ] User Entity Schema komplett
- [ ] Create Schema mit Password Validation
- [ ] Update Schema mit optionalen Feldern
- [ ] Filter Schema für Queries
- [ ] Type Exports verfügbar
- [ ] Alignment mit Prisma Schema

## Geschätzte Zeit
20 Minuten